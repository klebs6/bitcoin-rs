# Bitcoin Arena

`bitcoin-arena` is a Rust library that efficiently manages memory through an arena allocation mechanism. This crate is designed for robust and high-performance memory management, ideal for scenarios where allocation and deallocation patterns are regular and predictable. The core of the library is built around the concept of arenas, which are large pre-allocated regions of memory from which smaller chunks are allocated.

## Features

- **High Performance**: Leverages a best-fit allocation strategy with O(log n) complexity, ensuring optimal use of memory and minimal fragmentation.
- **Coalescing Free Chunks**: Supports automatic merging of adjacent free memory chunks, minimizing external fragmentation.
- **Safety**: Provides robust mechanisms to prevent invalid and double frees, wrapping operations in assertions.
- **Statistics and Debugging**: Offers comprehensive memory statistics and optional debugging output, tailored for developers requiring detailed insights into memory usage.

## Underlying Concepts

### Arena Allocation
Arena allocation allocates larger blocks of memory (arenas) upfront and then provides chunks from these pre-allocated blocks. This approach reduces heap fragmentation and improves allocation performance as allocations within the arena have minimal overhead.

### Memory Fragmentation
In computer science, memory fragmentation occurs due to repeated allocations and deallocations, leading to inefficient use of the memory. This crate implements techniques to mitigate fragmentation by maintaining free and used lists within an arena to allow for block merging.

## Usage
To use the `bitcoin-arena` crate, add the following to your `Cargo.toml`:

```toml
[dependencies]
bitcoin-arena = "0.1.3"
```

Below is an example demonstrating how to create an arena and allocate memory:

```rust
use bitcoin_arena::Arena;

fn main() {
    let base: *mut std::ffi::c_void = std::ptr::null_mut(); // Use a valid pointer
    let size: usize = 1024 * 1024; // 1 MB
    let alignment: usize = 8;

    let mut arena = Arena::new(base, size, alignment);
    let ptr = arena.alloc(128); // Allocate 128 bytes

    if !ptr.is_null() {
        println!("Allocated 128 bytes of memory.");
        arena.free(ptr); // Free the allocated block
    }
}
```

**Note**: Ensure that `base` represents a valid memory region; misuse can lead to undefined behavior.

## License
This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

*This README.md file was generated by an AI model and may not be 100% accurate; however, it should be pretty good.*