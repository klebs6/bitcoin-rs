# bitcoin-mem

The `bitcoin-mem` crate provides precise and efficient utilities for calculating memory usage and heap allocations in Rust containers, abstracting C++ style `memusage` logic. It is specifically designed for environments where memory footprint analysis is crucial, such as blockchain applications and other performance-sensitive systems.

## Features

- **Dynamic Memory Usage Calculation**: Easily measure the dynamic memory utilized by primitives, complex data structures such as `Vec`, `HashSet`, and `HashMap`, and smart pointers including `Arc`, `Box`, and custom structures.
- **Recursive Usage Evaluation**: Compute the cumulative memory consumption considering nested structures using `RecursiveDynamicUsage`.
- **Incremental Usage Assessment**: Determine the incremental memory usage of adding one more element to a container with `IncrementalDynamicUsage`.
- **C++ Memory Allocation Strategy**: Adopts a memory allocation strategy similar to that in C++, with granularity adjustments (8 or 16-byte buckets) depending on pointer size, intended to resonate with developers familiar with traditional systems-level programming paradigms.

## Crate Usage

To use the `bitcoin-mem` crate, add the following to your `Cargo.toml`:

```toml
[dependencies]
bitcoin-mem = "0.1.19"
```

Implement the `DynamicUsage`, `RecursiveDynamicUsage`, and `IncrementalDynamicUsage` traits for your custom data structures to effectively utilize these powerful memory usage insights.

## Technical Overview

Rust containers can mask significant heap usage in complex systems. `bitcoin-mem` assists in uncovering this hidden memory cost, providing accurate and reflective insights for performance tuning and resource management.

## Example

```rust
use bitcoin_mem::{DynamicUsage, RecursiveDynamicUsage, malloc_usage};

fn main() {
    let data: Vec<u32> = vec![1, 2, 3, 4, 5];
    let dynamic_usage = data.dynamic_usage();
    println!("Dynamic usage: {} bytes", dynamic_usage);
}
```

This README.md file was generated by an AI model and may not be 100% accurate, however, it should be pretty good.

## Repository

For more information and source code, visit the [GitHub repository](https://github.com/klebs6/bitcoin-rs).
